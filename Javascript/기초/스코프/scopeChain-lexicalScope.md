- 소스: https://poiemaweb.com/js-scope

### 스코프 체인

- 현재 스코프에 참조하려는 값이 존재하지 않는 경우 상위 스코프로 점진적으로 이동하면서 원하는 값을 찾아나갈 수 있음. 최상위에는 전역 스코프가 존재함.

- Local -> (Closure) -> Script -> Global

### 함수가 선언된 곳이 중요하다. (렉시컬 스코프)

```js
var x = 1;

function foo() {
  var x = 10;
  bar();
}

function bar() {
  console.log(x);
}

foo(); // ?
bar(); // ?
```

- 위 예제의 실행 결과는 함수 bar의 상위 스코프가 무엇인지에 따라 결정된다. 두가지 패턴을 예측할 수 있는데 첫번째는 함수를 어디서 호출하였는지에 따라 상위 스코프를 결정하는 것이고 두번째는 함수를 어디서 선언하였는지에 따라 상위 스코프를 결정하는 것이다. 첫번째 방식으로 함수의 상위 스코프를 결정한다면 함수 bar의 상위 스코프는 함수 foo와 전역일 것이고, 두번째 방식으로 함수의 스코프를 결정한다면 함수 bar의 스코프는 전역일 것이다.

- 프로그래밍 언어는 이 두가지 방식 중 하나의 방식으로 함수의 상위 스코프를 결정한다. 첫번째 방식을 동적 스코프(Dynamic scope)라 하고, 두번째 방식을 렉시컬 스코프(Lexical scope) 또는 정적 스코프(Static scope)라 한다. 자바스크립트를 비롯한 대부분의 프로그래밍 언어는 렉시컬 스코프를 따른다.
- 렉시컬 스코프는 함수를 어디서 호출하는지가 아니라 `어디에 선언`하였는지에 따라 결정된다. 자바스크립트는 렉시컬 스코프를 따르므로 `함수를 선언한 시점에 상위 스코프`가 결정된다. 함수를 어디에서 호출하였는지는 스코프 결정에 아무런 의미를 주지 않는다. 위 예제의 함수 bar는 전역에 선언되었다. 따라서 함수 bar의 상위 스코프는 전역 스코프이고 위 예제는 전역 변수 x의 값 1을 두번 출력한다.
